{% extends 'base_course.html' %}

{% block subtitle %}
{# I18N: Title of the G-Defier block webpage. #}
Block "{{ b_info.block_title }}"
{% endblock subtitle %}

{% block top_content %}
<div class="gcb-cols">
	<h1 class="gcb-col-12 gcb-aside" align="center" style="color:#555555">
		G-Defier Block "{{ b_info.block_title }}"
	</h1>
</div>
{% endblock %}

{% block main_content %}
<div class="parent">
  <div class="left" align="center">
        <h1> Stats </h1>
	    {% for key in b_stats recursive %}
	    	{% if key == 'request'%}
   		        <li>{{ key }} : 
   		        {% for inv in invitations recursive %}
   		        	<a onclick="acceptRequest()" id="inv">{{inv}}</a> 
   		        {% endfor %}
   		        </li>	
 		    {% else %}
    	        <li>{{ key }} : {{ b_stats[key] }}</li>	
			{% endif %}

	    {% endfor %}
	    <br>
        <h1> Block Info </h1>
	    {% for key in b_info recursive %}
	        <li>{{ key }} : {{ b_info[key] }}</li>	
	    {% endfor %}
  </div>
  <div class="right" align="center">
    <br>
	Please choose an opponent to send an invitation:
	<form id="form1" method='get'>
		<select size="{{players.__len__()}}" id="challenge2">
			{% for p in players %}
			<option>{{p}}</option>
			{% endfor %}
		</select>
	</form>
	<button class="gcb-button" type="button" onclick="displayResult()">
	Send Invitation
	</button>
  </div>
  <div class="center" align="center">
	<h1>My ongoing defies</h1>
    {% for def in my_defies recursive %}
    	{% if not def.rended or not def.lended%} 
	       	{% if user == def.rname%}    	
		   	<li><a href="gDefier/arena?defy={{def.key()}}">{{def.lname}}</a></li>	
			{% else %} 
	     	<li><a href="gDefier/arena?defy={{def.key()}}">{{def.rname}}</a></li>	
			{% endif %}
	 	{% endif %}       
    {% endfor %}
   	<h1>My ended defies</h1>
    {% for def in my_defies recursive %}
   		{% if def.rended and def.lended %}
	       	{% if user == def.rname%}    	
		   	<li><a href="gDefier/arena?defy={{def.key()}}">{{def.lname}}</a></li>	
			{% else %} 
	     	<li><a href="gDefier/arena?defy={{def.key()}}">{{def.rname}}</a></li>	
			{% endif %}
	  	{% endif %}      
    {% endfor %}
  </div>
</div>

<script>
function displayResult(){
	var x=document.getElementById("challenge2").selectedIndex;
	var y=document.getElementById("challenge2").options;
	window.location = window.location + '&request=' + y[x].text;
}

function acceptRequest()
{
var inv = document.getElementById('inv').text;
var conf = "\" has sent you an invitation to a challenge. Do you accept it?"
var r = confirm("\"" + inv + conf);
if (r==true) {
	window.location = window.location + '&accept=' + inv;
} else {
	window.location = window.location + '&reject=' + inv;
  }
}
</script>

<style type="text/css">
.parent{
    width:100%;
    heigth: 100%;
    min-height:100%;
    overflow:hidden;
}
.left{
    float:left;
    width:33%;
    height: 100%;
    overflow:hidden;
    }
.right{
	float:right;
    width:34%;
    height: 100%;    
    overflow:hidden;
}   
.center{
	float:center;
    width:33%;
    height: 100%;    
    overflow:hidden;
} 
</style>
{% endblock %}